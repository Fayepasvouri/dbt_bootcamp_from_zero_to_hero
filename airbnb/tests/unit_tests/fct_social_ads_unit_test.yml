unit_tests:
  - name: test_union_platforms
    model: fct_social_ads

    given:
      - input: ref('int_facebook_ads')
        rows:
          - ad_id: 1
            platform: facebook
            spend: 100

      - input: ref('int_tiktok_ads')
        rows:
          - ad_id: 2
            platform: tiktok
            spend: 200

    expect:
      rows:
      # Keep expectations minimal and portable across different tables/environments.
      # We assert only the key columns that are produced by the union/aggregation logic
      # so this test can run against tables with different additional metrics.
      - platform: facebook
        spend: 100

      - platform: tiktok
        spend: 200

